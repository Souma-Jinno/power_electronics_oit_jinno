# フライバックコンバータ（降圧動作、D < 0.5）

フライバックコンバータの降圧動作をシミュレーションします。変圧器を用いた絶縁型昇降圧コンバータで、デューティ比が0.5より小さい場合は降圧動作となります。

## 学習目標

- フライバックコンバータの動作原理を理解する
- ON時のエネルギー蓄積、OFF時のエネルギー転送を確認する
- 降圧動作（D < 0.5）の特性を理解する
- 非絶縁型昇降圧チョッパーとの違いを理解する

## 回路構成

### 回路パラメータ

| 素子 | 記号 | 値 | 備考 |
|------|------|-----|------|
| 入力電圧 | V1 | 12 V | |
| **1次側インダクタンス** | **L1** | **0.7 mH** | |
| **2次側インダクタンス** | **L2** | **0.7 mH** | |
| 結合係数 | K1 | 1.0 | 理想結合 |
| 出力コンデンサ | C1 | 500 μF | |
| 負荷抵抗 | R2 | 5 Ω | |
| **デューティ比** | **D** | **0.2941** | D < 0.5（降圧） |
| スイッチング周波数 | fsw | 20 kHz | |

### 巻数比

```
K1 L1 L2 1
n1:n2 = 1:1（L1 = L2）
```

## 理論解析

### 出力電圧の導出

フライバックコンバータの出力電圧は：

```
Vout = (n2/n1) × (D/(1-D)) × Vin
```

巻数比が 1:1、D = 0.2941 の場合：

```
Vout = 1 × (0.2941/(1-0.2941)) × 12 V
     = (0.2941/0.7059) × 12 V
     = 0.4166 × 12 V
     ≈ 5 V
```

### D < 0.5 の意味

デューティ比が0.5より小さい場合：

```
D/(1-D) < 0.5/0.5 = 1
```

したがって、

```
Vout < Vin  （降圧動作）
```

**今回の例:**
```
D/(1-D) = 0.2941/0.7059 ≈ 0.4166 < 1
Vout = 5 V < 12 V（入力）
```

## 動作原理

### ON時（スイッチ閉）

```
1. 入力電源 → スイッチ → L1 → GND
2. L1にエネルギーが蓄積される
3. 2次側ダイオードD2は逆バイアス（電流流れず）
4. C1から負荷に電力供給
```

**1次側インダクタ電流の増加:**

```
ΔIL1_on = (Vin × ton) / L1
        = (12 V × 14.7 μs) / 0.7 mH
        ≈ 252 mA
```

### OFF時（スイッチ開）

```
1. L1の蓄積エネルギーが2次側に転送
2. L1 → L2（磁気結合） → D2 → C1 + R2 → GND
3. 2次側ダイオードD2が導通
4. C1に充電し、負荷に電力供給
```

**2次側インダクタ電流の放出:**

```
2次側に誘導される電圧:
V_L2 = -(n2/n1) × VL1 = -VL1（巻数比1:1）
```

## エネルギー収支

### エネルギー蓄積（ON時）

```
E_stored = (1/2) × L1 × IL1²
```

### エネルギー転送（OFF時）

蓄積されたエネルギーがすべて2次側に転送され、負荷で消費されます。

定常状態では：

```
Pin = Pout
Vin × Iin_avg = Vout × Iout
```

## シミュレーション設定

```spice
.model SW SW(Ron=1m Roff=1G Vt=0.01)
.model D_ideal D(Ron=0.0001 Roff=100G Vfwd=0 epsilon=1m revepsilon=1m)
.tran 500m 500m 499.83m 0.2u
.param fsw=20k
.param Tsw=1/{fsw}
.param D=0.2941
K1 L1 L2 1
```

### パラメータ説明

- **シミュレーション時間**: 500 ms（起動から定常状態まで）
- **表示範囲**: 499.83 ms ～ 500 ms（定常状態のみ）
- **スイッチング周期**: Tsw = 50 μs
- **ON時間**: ton = D × Tsw = 0.2941 × 50 μs ≈ 14.7 μs
- **OFF時間**: toff = (1-D) × Tsw ≈ 35.3 μs

## 観察項目

### 1. 出力電圧 V(C1)

**期待される結果:**
- **平均値**: 約5 V
- **リプル**: 4.989 ～ 5.022 V程度（約33 mV p-p）
- **定常状態**: 500 ms付近

**確認ポイント:**
- 理論値（5 V）との一致
- リプル電圧の大きさ

### 2. 1次側電流 I(L1)

**期待される波形:**
- **ON時**: 直線的に増加（0.6 ～ 1.8 A）
- **OFF時**: 急速に0に戻る
- **三角波**: 非連続（電流が0になる）

**ピーク電流:**

```
IL1_peak ≈ (Vin × ton) / L1
         = (12 V × 14.7 μs) / 0.7 mH
         ≈ 252 mA
```

実際の波形では、負荷電流に応じてピーク値が決まります。

### 3. 2次側電流 I(L2)

**期待される波形:**
- **ON時**: 0 A（ダイオード逆バイアス）
- **OFF時**: 負の電流（-0.6 ～ -1.2 A程度）
- **パルス状**: OFF時のみ流れる

**重要な観察:**
- 2次側電流はOFF時のみ
- 1次側のエネルギーが2次側に転送される瞬間

### 4. インダクタ電圧 V(L1), V(L2)

**ON時:**
```
VL1 ≈ Vin = 12 V
VL2 ≈ 0 V（ダイオード逆バイアス）
```

**OFF時:**
```
VL1 ≈ -(1-D)/D × Vin（1次側で反転）
VL2 ≈ 巻数比に応じた電圧（2次側へ転送）
```

## 実験課題

### 課題1: 出力電圧の確認

理論計算した出力電圧（5 V）とシミュレーション結果を比較せよ。

### 課題2: デューティ比と出力電圧の関係

デューティ比を変化させて、出力電圧の変化を確認せよ：

| デューティ比 D | D/(1-D) | 理論出力電圧 | 動作モード |
|--------------|---------|-------------|----------|
| 0.2 | 0.25 | 3.0 V | 降圧 |
| 0.2941 | 0.417 | 5.0 V | 降圧 |
| 0.4 | 0.667 | 8.0 V | 降圧 |

### 課題3: エネルギー転送の観察

1次側電流と2次側電流の波形から、エネルギー転送のタイミングを確認せよ：
- ON時: 1次側にエネルギー蓄積
- OFF時: 2次側にエネルギー転送

### 課題4: 連続/不連続モードの判定

1次側電流が0に達するか確認し、連続導通モード（CCM）か不連続導通モード（DCM）かを判定せよ。

## 発展課題

### 1. 昇圧動作への変更

デューティ比を0.5より大きくして、昇圧動作を確認せよ：
- D = 0.7059 に変更（[flyback_converter_boost](../flyback_converter_boost/)を参照）
- 出力電圧が入力電圧より高くなることを確認

### 2. 負荷変動

負荷抵抗を変化させて、出力電圧の安定性を確認せよ：
- R2 = 2.5 Ω, 5 Ω, 10 Ω
- 軽負荷時の不連続モードへの移行を観察

### 3. リプル低減

出力コンデンサ容量を変化させて、リプル電圧を最小化せよ：
- C1 = 100 μF, 500 μF, 1000 μF
- リプル電圧の変化を測定

## フライバックコンバータの特徴

### メリット

1. **部品点数が少ない**: インダクタ、ダイオード、コンデンサのみ
2. **昇降圧が可能**: D < 0.5で降圧、D > 0.5で昇圧
3. **絶縁**: 入力と出力が電気的に絶縁
4. **極性反転可能**: 巻き方で出力極性を変更可能

### デメリット

1. **大きなリプル**: エネルギー転送がOFF時のみ
2. **スイッチングストレス**: 高い電圧・電流ストレス
3. **EMI**: スイッチング時のノイズが大きい
4. **出力フィルタが必要**: 大容量のコンデンサが必要

## 非絶縁型昇降圧チョッパーとの比較

### 共通点

- 同じ出力電圧式: Vout = D/(1-D) × Vin
- 昇降圧が可能
- エネルギー蓄積・転送方式

### 相違点

| 項目 | 非絶縁型 | フライバック |
|------|---------|------------|
| 絶縁 | なし | あり |
| 安全性 | 低 | 高 |
| 極性 | 反転 | 選択可能 |
| 巻数比 | - | 調整可能 |

## 教科書との対応

- **第6章 スライド36-40**: フライバックコンバータの回路構成と動作原理
- **スライド39**: 降圧モードの定常状態波形
- **式(Vout = D/(1-D) × Vin)**: 出力電圧の関係式

## 関連ファイル

- フォワードコンバータ: [../foward_converter/](../foward_converter/)
- フライバック（昇圧）: [../flyback_converter_boost/](../flyback_converter_boost/)
- 励磁電流（スイッチング）: [../exitation_current_switch/](../exitation_current_switch/)
- 非絶縁型昇降圧: [../../Lecture5/Fig.3.25(a)_back_boost_back/](../../Lecture5/Fig.3.25(a)_back_boost_back/)

---

[← Lecture6トップに戻る](../)
