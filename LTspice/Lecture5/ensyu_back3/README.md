# 演習3: インダクタンス値の影響（大容量化）

降圧チョッパー回路において、インダクタンス値を大きくした際の電圧・電流特性を観察する演習問題です。

## 学習目標

- インダクタンス値がコイル電流リプルに与える影響を理解する
- 大容量インダクタによるリプル低減効果を確認する
- 負荷変動に対する出力電圧の安定性を観察する
- 連続導通モード（CCM）と不連続導通モード（DCM）の境界がインダクタンスによってどう変化するか理解する
- 過渡応答時間とインダクタンスの関係を理解する

## 回路構成

### 回路パラメータ

| 素子 | 記号 | 値 | 備考 |
|------|------|-----|------|
| 入力電圧 | V1 | 10 V | |
| **インダクタンス** | **L1** | **300 mH** | **ensyu_backの10倍** |
| **負荷抵抗** | **Rx** | **10 Ω / 100 Ω / 500 Ω** | パラメトリック |
| スイッチング周波数 | fsw | 1 kHz | |
| デューティ比 | D | 0.5 | |

### 理論出力電圧

デューティ比 D = 0.5 の降圧チョッパーの出力電圧：

```
Vout = D × Vin = 0.5 × 10 = 5 V
```

### 負荷電流の理論値

各負荷抵抗における出力電流（オームの法則）：

| 負荷抵抗 Rx | 出力電流 Iout | 出力電力 Pout |
|------------|-------------|--------------|
| 10 Ω | 5 / 10 = 0.5 A | 2.5 W |
| 100 Ω | 5 / 100 = 0.05 A | 0.25 W |
| 500 Ω | 5 / 500 = 0.01 A | 0.05 W |

## シミュレーション設定

```spice
.tran 500m 500m 495m 0.1u
.param fsw=1k        ; スイッチング周波数 1kHz
.param Tsw=1/{fsw}   ; スイッチング周期 1ms
.param D=0.5         ; デューティ比 50%
.step param Rx list 10 100 500
```

**注意**: シミュレーション時間は 500ms と長めに設定されています。表示は 495ms ～ 500ms の定常状態のみです。

### なぜシミュレーション時間が長いのか

インダクタンスが大きい（300mH）ため：
1. **起動時の過渡応答が遅い**: 電流が定常状態に達するまで時間がかかる
2. **エネルギー蓄積時定数が大きい**: τ = L/R が大きい

## ensyu_back との比較

### パラメータの違い

| 項目 | ensyu_back | ensyu_back3 | 比率 |
|------|-----------|------------|------|
| インダクタンス | 30 mH | **300 mH** | 10倍 |
| シミュレーション時間 | 20 ms | **500 ms** | 25倍 |
| 表示時間範囲 | 全体 (0-20ms) | 定常状態のみ (495-500ms) | - |

### 期待される違い

**1. リプル電流の変化**

リプル電流はインダクタンスに反比例：

```
ΔiL = (Vin - Vout) × D × T / L

ensyu_back (L=30mH):
ΔiL = (10 - 5) × 0.5 × 0.001 / 0.03 ≈ 83.3 mA

ensyu_back3 (L=300mH):
ΔiL = (10 - 5) × 0.5 × 0.001 / 0.3 ≈ 8.33 mA (1/10に減少)
```

**2. CCM/DCM境界の変化**

リプルが小さくなるため、軽負荷でもCCMを維持しやすくなります：

| 負荷抵抗 Rx | ensyu_back (L=30mH) | ensyu_back3 (L=300mH) |
|-----------|-------------------|-------------------|
| 10 Ω | CCM | CCM |
| 100 Ω | CCM | CCM |
| 500 Ω | **DCM** | **CCM（境界付近）** |

**3. 過渡応答時間の変化**

時定数 τ = L/R が10倍になるため、起動時の過渡応答が遅くなります：

| 負荷抵抗 Rx | ensyu_back (L=30mH) | ensyu_back3 (L=300mH) |
|-----------|-------------------|-------------------|
| 10 Ω | τ = 3 ms | τ = 30 ms |
| 100 Ω | τ = 0.3 ms | τ = 3 ms |
| 500 Ω | τ = 0.06 ms | τ = 0.6 ms |

## 観察項目

### 1. 出力電圧 (Vout)

**期待される結果:**
- すべての負荷条件で約 5 V
- リプル電圧が ensyu_back より小さい
- 大容量インダクタにより平滑化が改善

**確認ポイント:**
- 定常状態での平均電圧値
- リプル電圧の大きさ（ensyu_backとの比較）
- 起動時の過渡応答（時定数の観察）

### 2. コイル電流 (IL)

**期待される結果:**

| 負荷抵抗 Rx | 平均電流 | リプル電流 ΔiL | 備考 |
|-----------|---------|--------------|------|
| 10 Ω | ≈ 0.5 A | ≈ 8.3 mA | CCM、リプル小 |
| 100 Ω | ≈ 0.05 A | ≈ 8.3 mA | CCM、リプル小 |
| 500 Ω | ≈ 0.01 A | ≈ 8.3 mA | CCM（境界付近） |

**重要な観察:**
- リプル電流が ensyu_back の 1/10 になる
- 500Ω負荷でも CCM を維持できる可能性が高い
- 起動時、電流がゆっくり増加する

### 3. ダイオード電流 (ID)

- スイッチOFF時にのみ流れる
- パルス幅は1ms（ensyu_backと同じ）
- 負荷が重いほど大きい
- リプル成分が小さい

### 4. 入力電流 (Iin)

- スイッチON時にのみ流れる
- パルス幅は0.5ms（D=0.5のため）
- リプル成分が小さい

## 連続導通モード (CCM) と不連続導通モード (DCM)

### 境界条件の再評価

コイル電流が0にならない条件（CCM）：

```
ΔiL / 2 < Iavg
```

各負荷での判定（L=300mH）：

| 負荷抵抗 Rx | 平均電流 Iavg | ΔiL / 2 | 判定 |
|-----------|-------------|---------|------|
| 10 Ω | 0.5 A | 0.00415 A | CCM (0.5 >> 0.00415) |
| 100 Ω | 0.05 A | 0.00415 A | CCM (0.05 >> 0.00415) |
| 500 Ω | 0.01 A | 0.00415 A | CCM (0.01 > 0.00415) |

**すべての負荷条件で CCM を維持**（インダクタンスを大きくした効果）

## 実験課題

### 課題1: リプル電流の測定

各負荷条件でコイル電流のリプルを測定し、理論値（≈8.3mA）と比較せよ。ensyu_back の結果と比較して、インダクタンスの影響を確認せよ。

### 課題2: CCM/DCMの判定

各負荷条件で、連続導通モード（CCM）か不連続導通モード（DCM）かを判定せよ。ensyu_back と比較して、境界条件がどう変化したか考察せよ。

### 課題3: 過渡応答の観察

シミュレーション時間範囲を 0 ～ 500ms に変更して、起動時の過渡応答を観察せよ：
1. `.tran 500m 500m 495m 0.1u` を `.tran 500m` に変更
2. 電流が定常状態に達するまでの時間を測定
3. 各負荷での時定数 τ = L/R を計算し、過渡応答と比較

### 課題4: インダクタンスとリプルの関係

ensyu_back と ensyu_back3 の結果から、インダクタンスとリプル電流の関係をグラフ化し、反比例の関係を確認せよ。

## 発展課題

### 1. インダクタンス設計

目標リプル電流（例: 平均電流の10%以下）を達成するために必要なインダクタンス値を、各負荷条件で計算せよ。

ヒント：
```
ΔiL < 0.1 × Iavg
(Vin - Vout) × D × T / L < 0.1 × Iavg
L > (Vin - Vout) × D × T / (0.1 × Iavg)
```

### 2. インダクタンススイープ

`.step param Lx list 10m 30m 100m 300m 1` を使って、複数のインダクタンス値でシミュレーションを実行し、リプル電流の変化をグラフ化せよ。

### 3. コストとサイズのトレードオフ

インダクタンスを大きくすると：
- **メリット**: リプル減少、CCM維持しやすい
- **デメリット**: サイズ増加、コスト増加、過渡応答遅延

最適なインダクタンス値を考察せよ。

## インダクタンス大容量化のメリット・デメリット

### メリット

1. **リプル電流の低減**: 同じ周波数で電流リプルが小さくなる
2. **DCM回避**: 軽負荷でもCCMを維持しやすい
3. **ノイズ低減**: 電流リプルが小さいため、EMIノイズも減少
4. **効率向上**: 電流リプルが小さいと、実素子での銅損が減少

### デメリット

1. **サイズ増加**: インダクタが大きく重くなる
2. **コスト増加**: 大容量インダクタは高価
3. **過渡応答の遅延**: 起動時や負荷変動時の応答が遅くなる
4. **DCR増加**: 大型インダクタはDC抵抗（DCR）が大きくなる傾向があり、損失増加の可能性

## 比較: ensyu_back2 との違い

### 同じリプル低減効果を得る2つの方法

**ensyu_back2**: 周波数を10倍（1kHz → 10kHz）
**ensyu_back3**: インダクタンスを10倍（30mH → 300mH）

どちらもリプル電流を1/10に低減できます：

| 方法 | メリット | デメリット |
|------|---------|-----------|
| 高周波化 | 小型化、応答速度向上 | スイッチング損失増加、EMI増加 |
| 大容量化 | スイッチング損失変わらず | サイズ増加、過渡応答遅延 |

実際の設計では、両方をバランスよく調整します。

## ヒント

### 表示時間範囲の調整

定常状態を観察するため、表示範囲を 495 ～ 500ms に絞っています。起動時の過渡応答を見たい場合は、`.tran` コマンドの3番目のパラメータを削除してください：

```spice
変更前: .tran 500m 500m 495m 0.1u
変更後: .tran 500m 500m 0 0.1u
```

### 時定数の理解

RL回路の時定数：
```
τ = L / R
```

定常状態に達するまでの時間は約 5τ です。

| 負荷抵抗 Rx | τ = L/R | 5τ（定常到達時間） |
|-----------|--------|------------------|
| 10 Ω | 30 ms | 150 ms |
| 100 Ω | 3 ms | 15 ms |
| 500 Ω | 0.6 ms | 3 ms |

## 関連ファイル

- 演習1（基本、L=30mH）: [../ensyu_back/](../ensyu_back/)
- 演習2（周波数変化）: [../ensyu_back2/](../ensyu_back2/)
- 基本的な降圧チョッパー: [../Fig3.1_back/](../Fig3.1_back/)
- コンデンサ付き降圧チョッパー: [../back_withC/](../back_withC/)

---

[← Lecture5トップに戻る](../)
