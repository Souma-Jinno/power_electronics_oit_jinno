# 演習2: スイッチング周波数の影響（高周波化）

降圧チョッパー回路において、スイッチング周波数を高くした際の電圧・電流特性を観察する演習問題です。

## 学習目標

- スイッチング周波数がコイル電流リプルに与える影響を理解する
- 高周波化によるリプル低減効果を確認する
- 負荷変動に対する出力電圧の安定性を観察する
- 連続導通モード（CCM）と不連続導通モード（DCM）の境界が周波数によってどう変化するか理解する

## 回路構成

### 回路パラメータ

| 素子 | 記号 | 値 | 備考 |
|------|------|-----|------|
| 入力電圧 | V1 | 10 V | |
| インダクタンス | L1 | 30 mH | |
| **負荷抵抗** | **Rx** | **10 Ω / 100 Ω / 500 Ω** | パラメトリック |
| **スイッチング周波数** | **fsw** | **10 kHz** | **ensyu_backの10倍** |
| デューティ比 | D | 0.5 | |

### 理論出力電圧

デューティ比 D = 0.5 の降圧チョッパーの出力電圧：

```
Vout = D × Vin = 0.5 × 10 = 5 V
```

### 負荷電流の理論値

各負荷抵抗における出力電流（オームの法則）：

| 負荷抵抗 Rx | 出力電流 Iout | 出力電力 Pout |
|------------|-------------|--------------|
| 10 Ω | 5 / 10 = 0.5 A | 2.5 W |
| 100 Ω | 5 / 100 = 0.05 A | 0.25 W |
| 500 Ω | 5 / 500 = 0.01 A | 0.05 W |

## シミュレーション設定

```spice
.tran 20m 20m 19.65m 0.1u
.param fsw=10k       ; スイッチング周波数 10kHz
.param Tsw=1/{fsw}   ; スイッチング周期 100μs
.param D=0.5         ; デューティ比 50%
.step param Rx list 10 100 500
```

**注意**: シミュレーション時間は 19.65ms ～ 20ms の定常状態のみを表示します。

## ensyu_back との比較

### パラメータの違い

| 項目 | ensyu_back | ensyu_back2 | 比率 |
|------|-----------|------------|------|
| スイッチング周波数 | 1 kHz | **10 kHz** | 10倍 |
| スイッチング周期 | 1 ms | **100 μs** | 1/10 |
| 表示時間範囲 | 全体 (0-20ms) | 定常状態のみ (19.65-20ms) | - |

### 期待される違い

**1. リプル電流の変化**

リプル電流は周波数に反比例：

```
ΔiL = (Vin - Vout) × D × T / L

ensyu_back (1kHz):
ΔiL = (10 - 5) × 0.5 × 0.001 / 0.03 ≈ 83.3 mA

ensyu_back2 (10kHz):
ΔiL = (10 - 5) × 0.5 × 0.0001 / 0.03 ≈ 8.33 mA (1/10に減少)
```

**2. CCM/DCM境界の変化**

リプルが小さくなるため、軽負荷でもCCMを維持しやすくなります：

| 負荷抵抗 Rx | ensyu_back (1kHz) | ensyu_back2 (10kHz) |
|-----------|------------------|-------------------|
| 10 Ω | CCM | CCM |
| 100 Ω | CCM | CCM |
| 500 Ω | **DCM** | **CCM（境界付近）** |

## 観察項目

### 1. 出力電圧 (Vout)

**期待される結果:**
- すべての負荷条件で約 5 V
- リプル電圧が ensyu_back より小さい
- 高周波化により平滑化が改善

**確認ポイント:**
- 定常状態での平均電圧値
- リプル電圧の大きさ（ensyu_backとの比較）

### 2. コイル電流 (IL)

**期待される結果:**

| 負荷抵抗 Rx | 平均電流 | リプル電流 ΔiL | 備考 |
|-----------|---------|--------------|------|
| 10 Ω | ≈ 0.5 A | ≈ 8.3 mA | CCM、リプル小 |
| 100 Ω | ≈ 0.05 A | ≈ 8.3 mA | CCM、リプル小 |
| 500 Ω | ≈ 0.01 A | ≈ 8.3 mA | CCM（境界付近） |

**重要な観察:**
- リプル電流が ensyu_back の 1/10 になる
- 500Ω負荷でも CCM を維持できる可能性が高い

### 3. ダイオード電流 (ID)

- スイッチOFF時にのみ流れる
- パルス幅が短くなる（100μs）
- 負荷が重いほど大きい

### 4. 入力電流 (Iin)

- スイッチON時にのみ流れる
- パルス幅が短くなる（50μs、D=0.5のため）
- 高周波化によりパルスが密になる

## 連続導通モード (CCM) と不連続導通モード (DCM)

### 境界条件の再評価

コイル電流が0にならない条件（CCM）：

```
ΔiL / 2 < Iavg
```

各負荷での判定（10kHz）：

| 負荷抵抗 Rx | 平均電流 Iavg | ΔiL / 2 | 判定 |
|-----------|-------------|---------|------|
| 10 Ω | 0.5 A | 0.00415 A | CCM (0.5 >> 0.00415) |
| 100 Ω | 0.05 A | 0.00415 A | CCM (0.05 >> 0.00415) |
| 500 Ω | 0.01 A | 0.00415 A | CCM (0.01 > 0.00415) |

**すべての負荷条件で CCM を維持**（周波数を高くした効果）

## 実験課題

### 課題1: リプル電流の測定

各負荷条件でコイル電流のリプルを測定し、理論値（≈8.3mA）と比較せよ。ensyu_back の結果と比較して、周波数の影響を確認せよ。

### 課題2: CCM/DCMの判定

各負荷条件で、連続導通モード（CCM）か不連続導通モード（DCM）かを判定せよ。ensyu_back と比較して、境界条件がどう変化したか考察せよ。

### 課題3: スイッチング周期の確認

波形からスイッチング周期を測定し、100μs（10kHz）であることを確認せよ。

### 課題4: 出力電圧リプルの比較

ensyu_back と ensyu_back2 の出力電圧波形を比較し、高周波化によるリプル低減効果を確認せよ（コンデンサがないため、リプルは主に負荷抵抗とインダクタで決まる）。

## 発展課題

### 1. 最適周波数の検討

リプル低減と損失（スイッチング損失は実際の素子で発生）のトレードオフを考慮して、最適なスイッチング周波数を考察せよ。

ヒント：
- 高周波化 → リプル減少、但しスイッチング損失増加
- 低周波化 → リプル増加、但しスイッチング損失減少

### 2. インダクタンス設計

目標リプル電流（例: 平均電流の10%以下）を達成するために必要なインダクタンス値を、各周波数（1kHz, 10kHz）で計算せよ。

### 3. 周波数スイープ

`.step param fsw list 1k 5k 10k 20k 50k` を使って、複数の周波数でシミュレーションを実行し、リプル電流の変化をグラフ化せよ。

## 高周波化のメリット・デメリット

### メリット

1. **リプル電流の低減**: 同じインダクタンスで電流リプルが小さくなる
2. **小型化**: 同じリプル仕様なら、小さいインダクタで実現可能
3. **応答性向上**: 制御応答が速くなる
4. **DCM回避**: 軽負荷でもCCMを維持しやすい

### デメリット

1. **スイッチング損失増加**: 実際の素子では、スイッチング回数に比例して損失が増加
2. **ノイズ増加**: 高周波ノイズ（EMI）が増加
3. **制御回路の高速化**: より高速な制御回路が必要
4. **コスト**: 高周波対応部品のコスト増加

## ヒント

### 表示時間範囲の違い

- **ensyu_back**: 0 ～ 20ms（起動過渡応答も含む）
- **ensyu_back2**: 19.65 ～ 20ms（定常状態のみ）

定常状態の波形をより詳細に観察するため、表示範囲を絞っています。

### 波形の見方

- スイッチング周期が短いため、波形が密になります
- LTspiceの拡大機能を使って、個々のスイッチング周期を観察してください
- 複数周期の平均的な動作を観察することも重要です

## 関連ファイル

- 演習1（基本、1kHz）: [../ensyu_back/](../ensyu_back/)
- 演習3（インダクタンス変化）: [../ensyu_back3/](../ensyu_back3/)
- 基本的な降圧チョッパー: [../Fig3.1_back/](../Fig3.1_back/)
- コンデンサ付き降圧チョッパー: [../back_withC/](../back_withC/)

---

[← Lecture5トップに戻る](../)
